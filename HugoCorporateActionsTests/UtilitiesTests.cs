using System;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using log4net;
using LoggingUtilitiesLib;
using Gargoyle.Utils.DBAccess;

using HugoCorporateActionsLib;
namespace HugoCorporateActionsTests
{
    [TestClass]
    public class UtilitiesTests
    {
       private static ILog s_logger;
       private static HugoCorporateActionsLib.HugoCorporateActionsUtilities s_utilities;
 
        [ClassInitialize]
        public static void Initialize(TestContext context)
        {
            log4net.Config.XmlConfigurator.Configure();
            s_logger = LogManager.GetLogger(typeof (UtilitiesTests));
            HugoCorporateActionsUtilities.OnError += Utilities_OnError;
            HugoCorporateActionsUtilities.OnInfo += Utilities_OnInfo;

            s_utilities.Init(DBAccess.GetDBAccessOfTheCurrentUser("CorporateActionsImport").GetConnection("Hugo"));
        }
        [ClassCleanup]
        public static void Cleanup()
        {
            s_utilities.Dispose();
        }

        private static void Utilities_OnError(object sender, EventArgs e)
        {
            HugoCorporateActionsLoggingEventArgs args = (HugoCorporateActionsLoggingEventArgs)e;
            s_logger.Error(args.Message, args.Exception);
        }
        private static void Utilities_OnInfo(object sender, EventArgs e)
        {
            HugoCorporateActionsLoggingEventArgs args = (HugoCorporateActionsLoggingEventArgs)e;
            s_logger.Info(args.Message);
         }


        [TestMethod]
        public void TestHugoInitialize()
        {
            bool expected = true;
            bool actual = s_utilities.IsInitialized;

            Assert.AreEqual(expected, actual, "Initialization failed");
        }

        [TestMethod]
        public void TestInsertCorporateActions()
        {
            string xml = "<?xml version=\"1.0\"?><root><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>9/16/2016 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>1.082068</CA_DIV_AMOUNT><DIVPAYDATE>10/31/2016 12:00:00 AM</DIVPAYDATE><RECORD_DATE>9/20/2016 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>6/17/2016 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>1.0784419</CA_DIV_AMOUNT><DIVPAYDATE>7/29/2016 12:00:00 AM</DIVPAYDATE><RECORD_DATE>6/21/2016 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>3/18/2016 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>1.049604</CA_DIV_AMOUNT><DIVPAYDATE>4/29/2016 12:00:00 AM</DIVPAYDATE><RECORD_DATE>3/22/2016 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>12/18/2015 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>1.21155</CA_DIV_AMOUNT><DIVPAYDATE>1/29/2016 12:00:00 AM</DIVPAYDATE><RECORD_DATE>12/22/2015 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>9/18/2015 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>1.03343</CA_DIV_AMOUNT><DIVPAYDATE>10/30/2015 12:00:00 AM</DIVPAYDATE><RECORD_DATE>9/22/2015 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>6/19/2015 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>1.03007</CA_DIV_AMOUNT><DIVPAYDATE>7/31/2015 12:00:00 AM</DIVPAYDATE><RECORD_DATE>6/23/2015 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>3/20/2015 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.93081</CA_DIV_AMOUNT><DIVPAYDATE>4/30/2015 12:00:00 AM</DIVPAYDATE><RECORD_DATE>3/24/2015 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>12/29/2014 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0</CA_DIV_AMOUNT><DIVPAYDATE>1/30/2015 12:00:00 AM</DIVPAYDATE><RECORD_DATE>12/31/2014 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>12/19/2014 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>1.13492</CA_DIV_AMOUNT><DIVPAYDATE>1/30/2015 12:00:00 AM</DIVPAYDATE><RECORD_DATE>12/23/2014 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>9/19/2014 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.93919</CA_DIV_AMOUNT><DIVPAYDATE>10/31/2014 12:00:00 AM</DIVPAYDATE><RECORD_DATE>9/23/2014 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>6/20/2014 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.93669</CA_DIV_AMOUNT><DIVPAYDATE>7/31/2014 12:00:00 AM</DIVPAYDATE><RECORD_DATE>6/24/2014 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>3/21/2014 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.82461</CA_DIV_AMOUNT><DIVPAYDATE>4/30/2014 12:00:00 AM</DIVPAYDATE><RECORD_DATE>3/25/2014 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>12/27/2013 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0</CA_DIV_AMOUNT><DIVPAYDATE>1/31/2014 12:00:00 AM</DIVPAYDATE><RECORD_DATE>12/31/2013 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>12/20/2013 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.98025</CA_DIV_AMOUNT><DIVPAYDATE>1/31/2014 12:00:00 AM</DIVPAYDATE><RECORD_DATE>12/24/2013 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>9/20/2013 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.83795</CA_DIV_AMOUNT><DIVPAYDATE>10/31/2013 12:00:00 AM</DIVPAYDATE><RECORD_DATE>9/24/2013 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>6/21/2013 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.83912</CA_DIV_AMOUNT><DIVPAYDATE>7/31/2013 12:00:00 AM</DIVPAYDATE><RECORD_DATE>6/25/2013 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>3/15/2013 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.693721</CA_DIV_AMOUNT><DIVPAYDATE>4/30/2013 12:00:00 AM</DIVPAYDATE><RECORD_DATE>3/19/2013 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>12/27/2012 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0</CA_DIV_AMOUNT><DIVPAYDATE>1/31/2013 12:00:00 AM</DIVPAYDATE><RECORD_DATE>12/31/2012 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>12/21/2012 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0</CA_DIV_AMOUNT><DIVPAYDATE>1/31/2013 12:00:00 AM</DIVPAYDATE><RECORD_DATE>12/26/2012 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>9/21/2012 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0</CA_DIV_AMOUNT><DIVPAYDATE>10/31/2012 12:00:00 AM</DIVPAYDATE><RECORD_DATE>9/25/2012 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>6/15/2012 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0</CA_DIV_AMOUNT><DIVPAYDATE>7/31/2012 12:00:00 AM</DIVPAYDATE><RECORD_DATE>6/19/2012 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>3/16/2012 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0</CA_DIV_AMOUNT><DIVPAYDATE>4/30/2012 12:00:00 AM</DIVPAYDATE><RECORD_DATE>3/20/2012 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>12/16/2011 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.77013</CA_DIV_AMOUNT><DIVPAYDATE>1/31/2012 12:00:00 AM</DIVPAYDATE><RECORD_DATE>12/20/2011 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>9/16/2011 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.62495</CA_DIV_AMOUNT><DIVPAYDATE>10/31/2011 12:00:00 AM</DIVPAYDATE><RECORD_DATE>9/20/2011 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>6/17/2011 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.62762</CA_DIV_AMOUNT><DIVPAYDATE>7/29/2011 12:00:00 AM</DIVPAYDATE><RECORD_DATE>6/21/2011 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>3/18/2011 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.55332</CA_DIV_AMOUNT><DIVPAYDATE>4/29/2011 12:00:00 AM</DIVPAYDATE><RECORD_DATE>3/22/2011 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>12/17/2010 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.65276</CA_DIV_AMOUNT><DIVPAYDATE>1/31/2011 12:00:00 AM</DIVPAYDATE><RECORD_DATE>12/21/2010 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>9/17/2010 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.60213</CA_DIV_AMOUNT><DIVPAYDATE>10/29/2010 12:00:00 AM</DIVPAYDATE><RECORD_DATE>9/21/2010 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>6/18/2010 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.53128</CA_DIV_AMOUNT><DIVPAYDATE>7/30/2010 12:00:00 AM</DIVPAYDATE><RECORD_DATE>6/22/2010 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>3/19/2010 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.48038</CA_DIV_AMOUNT><DIVPAYDATE>4/30/2010 12:00:00 AM</DIVPAYDATE><RECORD_DATE>3/23/2010 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>12/18/2009 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.59019</CA_DIV_AMOUNT><DIVPAYDATE>1/29/2010 12:00:00 AM</DIVPAYDATE><RECORD_DATE>12/22/2009 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>9/18/2009 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.50833</CA_DIV_AMOUNT><DIVPAYDATE>10/30/2009 12:00:00 AM</DIVPAYDATE><RECORD_DATE>9/22/2009 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>6/19/2009 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.51819</CA_DIV_AMOUNT><DIVPAYDATE>7/31/2009 12:00:00 AM</DIVPAYDATE><RECORD_DATE>6/23/2009 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>3/20/2009 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.56143</CA_DIV_AMOUNT><DIVPAYDATE>4/30/2009 12:00:00 AM</DIVPAYDATE><RECORD_DATE>3/24/2009 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>2/24/2009 12:00:00 AM</CA_EFF_DATE><CA_TYPE>1</CA_TYPE><CA_IPO_SYMBOL>SPY</CA_IPO_SYMBOL><CA_EXCH_NAME>ARC</CA_EXCH_NAME></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>12/19/2008 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.71934</CA_DIV_AMOUNT><DIVPAYDATE>1/30/2009 12:00:00 AM</DIVPAYDATE><RECORD_DATE>12/23/2008 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>9/19/2008 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.69092</CA_DIV_AMOUNT><DIVPAYDATE>10/31/2008 12:00:00 AM</DIVPAYDATE><RECORD_DATE>9/23/2008 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>6/20/2008 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.66922</CA_DIV_AMOUNT><DIVPAYDATE>7/31/2008 12:00:00 AM</DIVPAYDATE><RECORD_DATE>6/24/2008 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>3/20/2008 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.64195</CA_DIV_AMOUNT><DIVPAYDATE>4/30/2008 12:00:00 AM</DIVPAYDATE><RECORD_DATE>3/25/2008 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>12/21/2007 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.77541</CA_DIV_AMOUNT><DIVPAYDATE>1/31/2008 12:00:00 AM</DIVPAYDATE><RECORD_DATE>12/26/2007 12:00:00 AM</RECORD_DATE></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>9/21/2007 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.71872</CA_DIV_AMOUNT><DIVPAYDATE>10/31/2007 12:00:00 AM</DIVPAYDATE><RECORD_DATE>9/25/2007 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>6/15/2007 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.6556</CA_DIV_AMOUNT><DIVPAYDATE>7/31/2007 12:00:00 AM</DIVPAYDATE><RECORD_DATE>6/19/2007 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>3/16/2007 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.55127</CA_DIV_AMOUNT><DIVPAYDATE>4/30/2007 12:00:00 AM</DIVPAYDATE><RECORD_DATE>3/20/2007 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>12/15/2006 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.79265</CA_DIV_AMOUNT><DIVPAYDATE>1/31/2007 12:00:00 AM</DIVPAYDATE><RECORD_DATE>12/19/2006 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>9/15/2006 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.57934</CA_DIV_AMOUNT><DIVPAYDATE>10/31/2006 12:00:00 AM</DIVPAYDATE><RECORD_DATE>9/19/2006 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>6/16/2006 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.55547</CA_DIV_AMOUNT><DIVPAYDATE>7/31/2006 12:00:00 AM</DIVPAYDATE><RECORD_DATE>6/20/2006 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>3/17/2006 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.51947</CA_DIV_AMOUNT><DIVPAYDATE>4/28/2006 12:00:00 AM</DIVPAYDATE><RECORD_DATE>3/21/2006 12:00:00 AM</RECORD_DATE></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>12/16/2005 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.67167</CA_DIV_AMOUNT><DIVPAYDATE>1/31/2006 12:00:00 AM</DIVPAYDATE><RECORD_DATE>12/20/2005 12:00:00 AM</RECORD_DATE></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>9/16/2005 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.52169</CA_DIV_AMOUNT><DIVPAYDATE>10/31/2005 12:00:00 AM</DIVPAYDATE><RECORD_DATE>9/20/2005 12:00:00 AM</RECORD_DATE></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>6/17/2005 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.48762</CA_DIV_AMOUNT><DIVPAYDATE>7/29/2005 12:00:00 AM</DIVPAYDATE><RECORD_DATE>6/21/2005 12:00:00 AM</RECORD_DATE></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>3/18/2005 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.46709</CA_DIV_AMOUNT><DIVPAYDATE>4/29/2005 12:00:00 AM</DIVPAYDATE><RECORD_DATE>3/22/2005 12:00:00 AM</RECORD_DATE><DIVIDENDTP>X</DIVIDENDTP></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>12/17/2004 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.56789</CA_DIV_AMOUNT><DIVPAYDATE>1/31/2005 12:00:00 AM</DIVPAYDATE><RECORD_DATE>12/21/2004 12:00:00 AM</RECORD_DATE></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>11/15/2004 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.35102</CA_DIV_AMOUNT><DIVPAYDATE>12/2/2004 12:00:00 AM</DIVPAYDATE><RECORD_DATE>11/17/2004 12:00:00 AM</RECORD_DATE></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>9/17/2004 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.46878</CA_DIV_AMOUNT><DIVPAYDATE>10/29/2004 12:00:00 AM</DIVPAYDATE><RECORD_DATE>9/21/2004 12:00:00 AM</RECORD_DATE></Row><Row><DISP_NAME>SPY</DISP_NAME><CA_EFF_DATE>6/18/2004 12:00:00 AM</CA_EFF_DATE><CA_TYPE>32</CA_TYPE><CA_DIV_AMOUNT>0.41376</CA_DIV_AMOUNT><DIVPAYDATE>7/30/2004 12:00:00 AM</DIVPAYDATE><RECORD_DATE>6/22/2004 12:00:00 AM</RECORD_DATE></Row></root>";

            int expected = 55;
            int actual = s_utilities.InsertCorporateActions("RealTick", xml, null);

            Assert.AreEqual(expected, actual, "InsertCorporateActions failed");
        }

        [TestMethod]
        public void TestGetMarketMakingUnderlyings()
        {
            int expected = 5;
            string[] list = s_utilities.GetAllStocks();
            int actual = list.Length;

            Assert.AreEqual(expected, actual, "GetAllStocks failed");
        }
    }
}
